#include <iostream>
#include <unordered_map>
#include <string.h>
#include <array>
#include <omp.h>
#include <math.h>
#include <complex>
#include <algorithm>



#define __DATA_DOUBLE
#ifdef __DATA_DOUBLE
//using MKL_Complex16 = double;
using Data_dtype = double;
#else
using MKL_Complex16 = std::complex<double>;
using Data_dtype = std::complex<double>;
#endif

using MKL_INT = unsigned long;
//#include<mkl.h>

using Data_basis = unsigned char;
//#include<mkl.h>
//#include<mkl_spblas.h>

//#define __PRINT_BASIS
#ifdef __PRINT_BASIS
#define __PRINT_BASIS_DETAIL
#define __PRINT_Z2INDEX
#endif

#define __TIMER
#ifdef __TIMER
#include "time/time.cc"
#endif

#ifndef __PRINTCG
//#define __PRINTCG
#endif

//--------------------------------------------------------------------------------------------------------------------
//------------------------- declaration ------------------------------------------------------------------
//--------------------------------------------------------------------------------------------------------------------

//#define bool	_Bool
//#define true	1
//#define false	0
#define ULIMAX 0xFFFFFFFFFFFFFFFF

#include "CGC/cg_general.h"
#include "QHFM_fermion.h"
#include "Basis/Basis.h"
#include "CGC/CGC.h"
#include "A_list/A_list.h"
#include "Hamiltonian/Hamiltonian.h"
//#include "Entanglement/Entanglement.h"
//#include "Measurement/Measurement.h"


#include "CGC/cg_general.cc"
#include "Basis/Basis.c"
#include "CGC/CGC.c"
#include "A_list/A_list.c"
#include "Hamiltonian/Hamiltonian.c"
//#include "Entanglement/EntanglementMatrix.c"
//#include "Measurement/Measurement.c"


//--------------------------------------------------------------------------------------------------------------------


int main(int argc, char* argv[])
{	
	hu::timer hutm;
	size_t N_o = 4;
	size_t N_e = 4;
	int L_z = 2+(N_o-1)*N_e/2;
	int l = 0;
	int m = 0;
	int la = N_o-2;
	int lb = N_o-2;


	printf("init FQHE status: %d\n", init_FQHE(N_o, N_e));
	printf("init FQHE status: %d\n", init_FQHE_B(N_o, N_e));
	create_Lz_space(L_z);

	double alphalist[8] = {1,1,1,1,0,0,0,0};
	double betalist[8] = {0,0,0,0,1,1,1,1};

	double A_matirx[4] = {1.0, 0.0, 0.0, -1.0};
	double B_matirx[4] = {1.0, 0.0, 0.0, -1.0};
	Data_dtype *resu = (Data_dtype *)malloc((size_t) (A.dim) * sizeof(Data_dtype));
	Data_dtype vec[1064] = {0.20459965308857028, 0.10847236461166132, -0.1084723646116613, 0.07559996703043671, 0.10847236461166138, -0.07559996703043674, 0.005797055513274202, 0.06711394668300022, 0.06226436374299703, -0.10847236461166132, 0.07163982420163309, 0.005797055513274202, -0.005987173189320217, -0.07107408951180397, -0.062264363742997056, 0.0015221811224916074, 0.005610804808385101, 0.06459529017882074, 0.004811522392849978, 0.05670849624554929, 0.0008738336374416753, -0.004651836636041075, -0.049675580314884234, 0.058537912888765094, 0.10847236461166122, -0.06767968137282934, -0.005987173189320217, 0.004478807992035359, 0.07017513284087029, 0.005610804808385101, 0.058097463119911257, 0.004811522392849978, -0.0013182475212388282, -0.006439466570551459, -0.0694543896785581, -0.0052367231473313975, -0.05779849614896913, -0.004651836636041075, -0.0007567621287058402, 0.0037473593264603002, 0.00450412145516615, 0.0527524810345502, -0.058537912888765094, 0.0002097318752974471, 0.0017199849029143769, 0.005479557592380922, 0.06397483208617721, 0.0012937747540244806, 0.004561059714365358, 0.05016053571493779, 0.00450412145516615, 0.00012711235579162606, -0.00023913467449468556, -0.0036404150488708272, -0.004404509321913853, -0.05142487243230237, 0.004476893852306117, 0.054061019036458935, -0.00012711235579161907, 0.00088363198126292, -0.0008532916317665745, -0.0007231128232918335, 0.004702720137837072, 0.046167071478621924, 0.0009424649416523055, -0.004847221863100893, -0.04864166024250061, 9.573268070244046e-05, -0.0007092239947736832, 0.0010361405354907878, 0.0032149188102567113, 0.04393550099032092, 0.062264363742996945, -0.1084723646116613, 0.06462007304052449, 0.004478807992035359, 0.0015221811224916074, -0.0028268912238798884, -0.06747510717693889, -0.006439466570551459, -0.053413595545199324, -0.0052367231473313975, 0.0008738336374416753, 0.0006908026212014055, 0.004940183589820721, 0.06973446608241349, 0.005479557592380922, 0.003907059772313509, 0.05536137024127573, 0.004561059714365358, 0.0037473593264603002, 0.0003898545958344898, -0.0024357367765050716, -0.004611065732755639, -0.05090790548067611, -0.004404509321913853, 0.05406101903645903, 0.004476893852306117, -0.001318247521238836, -0.006439466570551471, -0.0694543896785582, -0.0009706506838848127, -0.005073363064932684, -0.052234718511073905, -0.004611065732755639, -0.0036404150488708272, 0.00016336008239872102, 0.0027048764098513336, 0.004866080220235784, 0.004406576266662144, 0.05411001790950105, 0.004702720137837072, -0.00484722186310089, -0.05420242585359838, -0.004847221863100893, -0.0004765232046902741, 0.0006697434260839583, -0.0002658394147157541, -0.003956584691659698, -0.004362968373624236, -0.050373312241566326, -0.0007092239947736772, 0.0038775143172799505, 0.00429837047672401, 0.050780939626650166, 0.0032149188102567113, 0.00038875954306311045, -0.00019426887650971818, -0.0022411615753155497, -0.0042471061383823555, -0.04613170864133813, -0.06226436374299698, 0.001522181122491604, 0.005610804808385128, 0.06459529017882072, 0.0011208108672599816, 0.0042024077725311285, 0.00039769804396813576, 0.04568065038929392, 0.004406576266662144, -0.0007231128232918335, -0.00020303820677294932, -0.001070570595876702, -0.0023300812537566467, -0.004566006580397202, -0.04929197500327039, -0.004362968373624236, 0.001036140535490781, 0.00429837047672401, 0.04675742979815836, 0.00429837047672401, 0.0010361405354907878, 0.0004765232046902746, 0.00026583941471574604, -0.0006697434260839638, 0.00395658469165967, 0.004362968373624243, 0.05037331224156621, -0.00019426887650973374, -0.0037490175335988182, -0.004298370476724033, -0.04797174296818626, -0.0042471061383823555, -0.00032545703307396747, 7.527986293138131e-05, 0.0007765427305859982, 0.002468052562942664, 0.0038800636835164375, 0.00381231175559483, 0.04558067158157532, 0.0048115223928499925, 0.058097463119911257, 0.00012711235579163162, -0.000883631981262936, 0.0007231128232918463, 0.0008532916317665967, -0.004702720137837073, -0.046167071478621834, 0.0007765427305859846, -0.0006794751021880111, -0.0007010511266446017, 0.0043822337072097995, 0.0003463305798848575, 0.04144784925887015, 0.00381231175559483, -0.00013677127756427413, -7.630734535704239e-05, 0.0006846425288969675, -0.00022830373547563925, -0.0021489924324162063, -0.004438780120678811, -0.044214810671041625, 0.000873833637441675, -0.005236723147331382, -0.05341359554519939, 2.8264270447871874e-05, 0.0001085070071163876, 0.0003647843398296974, -0.0005929178225359929, -0.0005929178225359963, 0.0010583555692125677, 0.0033168500479782027, 0.04089796062306344, -0.0007567621287058343, 0.0012937747540244689, 0.003907059772313526, 0.04950653577288592, 0.00012711235579163712, 0.0003898545958344824, -0.0009706506838848016, -0.0021966021020103604, -0.046630508514554025, 0.07559996703043675, 0.10847236461166136, -0.06246099920471852, -0.0028268912238798884, -0.0013182475212388282, 0.0014682712146046105, 0.06469399742292417, 0.004940183589820721, 0.0017199849029143769, 0.04950653577288592, 0.003907059772313509, 0.0012937747540244806, -0.0007567621287058402, -0.002826891223879904, -0.06747510717693889, -0.006439466570551471, -0.0021966021020103596, -0.0517359129778391, -0.005073363064932684, -0.0024357367765050716, -0.00023913467449468556, 0.0012878279715257763, 0.004310158474954788, 0.047327787094356075, 0.00039769804396813576, 0.004866080220235784, -0.0008532916317665745, -0.048641660242500606, -0.00484722186310089, 0.0009424649416523055, 0.00447880799203536, 0.07017513284087026, 0.005610804808385128, 0.00342652649369185, 0.05098850485523211, 0.004310158474954788, 0.0042024077725311285, 0.0027048764098513336, 0.00088363198126292, -0.0015375540754382377, -0.0032748534643328425, -0.004573513020470913, -0.05238738952169481, -0.004566006580397202, -0.003956584691659698, 0.0032149188102567052, 0.0507809396266501, 0.00429837047672401, 0.0038775143172799505, -0.0007092239947736832, 0.00020303820677293846, 0.0023300812537566436, 0.0010705705958767118, 0.004566006580397162, 0.0492919750032704, 0.004362968373624243, -0.002241161575315534, -0.0042983704767240285, -0.04798340781305179, -0.004298370476724033, -0.0022411615753155497, 7.527986293138571e-05, 0.0012360301859325247, -0.0006794751021880241, 0.00417938386932557, 0.04336311244428756, 0.0003463305798848575, 0.0038800636835164375, 0.056708496245549335, 0.0048115223928499925, -0.005987173189320227, -0.07107408951180394, -0.004307673605755158, -0.00034211853946147395, -0.0487535439532685, -0.004573513020470913, -0.0023300812537566467, -0.0002658394147157541, 0.001537554075438232, 0.004573513020470905, 0.00327485346433285, 0.05238738952169474, 0.004566006580397162, 0.00395658469165967, -0.004247106138382343, -0.0479717429681863, -0.0042983704767240285, -0.0037490175335988182, -0.00019426887650971818, -0.00016336008239872774, -0.0027048764098513596, -0.004406576266662166, -0.004866080220235801, -0.054110017909500964, -0.004702720137837073, 0.0024680525629426674, 0.004179383869325582, 0.004382233707209798, 0.04989959869263653, 0.00417938386932557, 0.0043822337072097995, 0.002468052562942664, -7.630734535704799e-05, -0.0015611607409507415, -0.0037863971509758815, -0.0032806580459569207, -0.004169031825978456, -0.04698328244384036, -0.004438780120678811, -0.004651836636041071, -0.057798496148969085, -0.005236723147331382, -0.00012711235579163712, 0.00023913467449469087, 0.0036404150488708186, 0.0044045093219138645, 0.051424872432302295, -0.00022830373547562716, -0.0032806580459569185, -0.00026846103697371186, -0.004024065246451751, -0.04470601540860378, -0.004169031825978456, -0.0021489924324162063, 0.0001085070071163876, 0.0002879483343579712, 0.0013618499474431153, 0.003250815739563896, 0.003250815739563905, 0.004078721332503379, 0.047501987748142016, 0.0033168500479782027, 0.0037473593264603124, 0.004561059714365371, 0.055361370241275694, 0.003907059772313526, -0.00013677127756427413, -7.630734535704799e-05, -0.00022830373547562716, -0.0021489924324162046, 0.0006846425288969619, -0.004438780120678825, -0.04421481067104158, -0.00023913467449469087, -0.0024357367765050412, -0.005073363064932682, -0.051735912977839096, -0.0021966021020103604, -0.00012711235579163162, 0.00016336008239872774, 0.0012878279715257965, 0.0011208108672599811, 0.003426526493691878, 0.048308191081914253, -0.07559996703043673, 0.0057970555132742, 0.06711394668300026, 0.0039445968904168165, 0.00034211853946148523, 0.043821720463774534, 0.00327485346433285, 0.0010705705958767118, -0.0006697434260839638, -0.0012878279715257965, -0.004310158474954781, -0.000397698043968143, -0.04732778709435607, -0.004866080220235801, 0.0008532916317665967, 0.0038123117555948337, 0.0003463305798848546, 0.04144784925887014, 0.004382233707209798, -0.0006794751021880241, -0.0007010511266446017, 0.0007765427305859982, -0.0003898545958344824, 0.0024357367765050412, 0.004611065732755635, 0.05090790548067625, 0.0044045093219138645, -0.0021489924324162046, -0.004169031825978458, -0.0002684610369737029, -0.04470601540860379, -0.004024065246451751, -0.0032806580459569207, -0.00022830373547563925, 0.0003647843398296974, 0.0013618499474431153, 0.000421531813121904, 0.003843733562099895, 0.0038437335620999068, 0.04251990730524131, 0.004078721332503379, 0.0010583555692125677, 0.004504121455166149, 0.05016053571493776, 0.004561059714365371, 0.0012937747540244689, 0.0007567621287058343, -0.0037473593264603124, -0.004504121455166149, -0.05275248103455018, -0.0005929178225359929, 0.003250815739563896, 0.003843733562099895, 0.0005198725626523419, 0.04388358082833394, 0.0038437335620999068, 0.003250815739563905, -0.0005929178225359963, -7.630734535704239e-05, -0.0015611607409507415, -0.0032806580459569185, -0.004169031825978458, -0.0037863971509758884, -0.04698328244384046, -0.004438780120678825, -0.0036404150488708186, -0.004611065732755635, -0.052234718511073905, -0.005073363064932682, -0.0009706506838848016, -0.00032545703307396747, 0.0007765427305859846, 7.527986293138571e-05, 0.0024680525629426674, 0.0038123117555948337, 0.0038800636835164383, 0.04558067158157532, 0.000883631981262936, 0.0027048764098513596, 0.004310158474954781, 0.0042024077725311354, 0.05098850485523212, 0.003426526493691878, -0.0004765232046902746, -0.00020303820677293846, -0.001537554075438232, -0.0039445968904168165, -0.004307673605755154, -0.047954281625344854, 0.0057970555132742, 0.07163982420163308, -0.000873833637441675, 0.004651836636041071, 0.049675580314884206, 0.0006846425288969675, -0.0037863971509758815, -0.00026846103697371186, -0.0002684610369737029, -0.038874648215131154, -0.0037863971509758884, 0.0006846425288969619, 7.527986293138131e-05, -0.0006794751021880111, 0.0012360301859325247, 0.004179383869325582, 0.0003463305798848546, 0.043363112444287526, 0.0038800636835164383, -0.0007231128232918463, 0.004406576266662166, 0.000397698043968143, 0.04568065038929391, 0.0042024077725311354, 0.0011208108672599811, 0.00038875954306311045, -0.00019426887650973374, -0.002241161575315534, -0.004247106138382343, -0.046131708641338094, -0.00026583941471574604, -0.0023300812537566436, -0.004573513020470905, -0.00034211853946148523, -0.048753543953268474, -0.004307673605755154, 0.0004765232046902741, 0.00020303820677294932, 0.0015375540754382377, 0.004307673605755158, 0.003944596890416827, 0.04795428162534484, -0.005987173189320227, -0.06767968137282931, 9.573268070244046e-05, -0.0007092239947736772, 0.001036140535490781, 0.0032149188102567052, 0.04393550099032092, -0.0006697434260839583, 0.001070570595876702, 0.0032748534643328425, 0.00034211853946147395, 0.04382172046377457, 0.003944596890416827, 0.00012711235579161907, -0.00016336008239872102, -0.0011208108672599816, -0.0012878279715257763, -0.00342652649369185, -0.048308191081914274, 0.001522181122491604, 0.00447880799203536, 0.06462007304052451, -0.00012711235579162606, -0.0003898545958344898, 0.0009706506838848127, 0.0021966021020103596, 0.04663050851455402, -0.001318247521238836, -0.002826891223879904, -0.062460999204718516, 0.0002097318752974471, 0.0006908026212014055, 0.0014682712146046105, 0.0609927279901139, 0.10847236461166126, -0.10847236461166126, 0.0609927279901139, 0.0014682712146046105, 0.0006908026212014055, 0.0002097318752974471, -0.062460999204718516, -0.002826891223879904, -0.001318247521238836, -0.04663050851455402, -0.0021966021020103596, -0.0009706506838848127, 0.0003898545958344898, 0.00012711235579162606, 0.06462007304052451, 0.00447880799203536, 0.001522181122491604, 0.048308191081914274, 0.00342652649369185, 0.0012878279715257763, 0.0011208108672599816, 0.00016336008239872102, -0.00012711235579161907, -0.003944596890416827, -0.04382172046377457, -0.00034211853946147395, -0.0032748534643328425, -0.001070570595876702, 0.0006697434260839583, 0.04393550099032092, 0.0032149188102567052, 0.001036140535490781, -0.0007092239947736772, 9.573268070244046e-05, -0.06767968137282931, -0.005987173189320227, -0.04795428162534484, -0.003944596890416827, -0.004307673605755158, -0.0015375540754382377, -0.00020303820677294932, -0.0004765232046902741, 0.004307673605755154, 0.048753543953268474, 0.00034211853946148523, 0.004573513020470905, 0.0023300812537566436, 0.00026583941471574604, -0.046131708641338094, -0.004247106138382343, -0.002241161575315534, -0.00019426887650973374, 0.00038875954306311045, -0.0011208108672599811, -0.0042024077725311354, -0.04568065038929391, -0.000397698043968143, -0.004406576266662166, 0.0007231128232918463, 0.0038800636835164383, 0.043363112444287526, 0.0003463305798848546, 0.004179383869325582, 0.0012360301859325247, -0.0006794751021880111, 7.527986293138131e-05, 0.0006846425288969619, -0.0037863971509758884, -0.038874648215131154, -0.0002684610369737029, -0.00026846103697371186, -0.0037863971509758815, 0.0006846425288969675, -0.049675580314884206, -0.004651836636041071, 0.000873833637441675, 0.07163982420163308, 0.0057970555132742, 0.047954281625344854, 0.004307673605755154, 0.0039445968904168165, 0.001537554075438232, 0.00020303820677293846, 0.0004765232046902746, -0.003426526493691878, -0.05098850485523212, -0.0042024077725311354, -0.004310158474954781, -0.0027048764098513596, -0.000883631981262936, 0.04558067158157532, 0.0038800636835164383, 0.0038123117555948337, 0.0024680525629426674, 7.527986293138571e-05, 0.0007765427305859846, -0.00032545703307396747, 0.0009706506838848016, 0.005073363064932682, 0.052234718511073905, 0.004611065732755635, 0.0036404150488708186, -0.004438780120678825, -0.04698328244384046, -0.0037863971509758884, -0.004169031825978458, -0.0032806580459569185, -0.0015611607409507415, -7.630734535704239e-05, -0.0005929178225359963, 0.003250815739563905, 0.0038437335620999068, 0.04388358082833394, 0.0005198725626523419, 0.003843733562099895, 0.003250815739563896, -0.0005929178225359929, 0.05275248103455018, 0.004504121455166149, 0.0037473593264603124, -0.0007567621287058343, -0.0012937747540244689, -0.004561059714365371, -0.05016053571493776, -0.004504121455166149, 0.0010583555692125677, 0.004078721332503379, 0.04251990730524131, 0.0038437335620999068, 0.003843733562099895, 0.000421531813121904, 0.0013618499474431153, 0.0003647843398296974, -0.00022830373547563925, -0.0032806580459569207, -0.004024065246451751, -0.04470601540860379, -0.0002684610369737029, -0.004169031825978458, -0.0021489924324162046, -0.0044045093219138645, -0.05090790548067625, -0.004611065732755635, -0.0024357367765050412, 0.0003898545958344824, 0.0007765427305859982, -0.0007010511266446017, -0.0006794751021880241, 0.004382233707209798, 0.04144784925887014, 0.0003463305798848546, 0.0038123117555948337, -0.0008532916317665967, 0.004866080220235801, 0.04732778709435607, 0.000397698043968143, 0.004310158474954781, 0.0012878279715257965, 0.0006697434260839638, -0.0010705705958767118, -0.00327485346433285, -0.043821720463774534, -0.00034211853946148523, -0.0039445968904168165, 0.06711394668300026, 0.0057970555132742, -0.07559996703043673, -0.048308191081914253, -0.003426526493691878, -0.0011208108672599811, -0.0012878279715257965, -0.00016336008239872774, 0.00012711235579163162, 0.0021966021020103604, 0.051735912977839096, 0.005073363064932682, 0.0024357367765050412, 0.00023913467449469087, -0.04421481067104158, -0.004438780120678825, 0.0006846425288969619, -0.0021489924324162046, -0.00022830373547562716, -7.630734535704799e-05, -0.00013677127756427413, -0.003907059772313526, -0.055361370241275694, -0.004561059714365371, -0.0037473593264603124, 0.0033168500479782027, 0.047501987748142016, 0.004078721332503379, 0.003250815739563905, 0.003250815739563896, 0.0013618499474431153, 0.0002879483343579712, 0.0001085070071163876, -0.0021489924324162063, -0.004169031825978456, -0.04470601540860378, -0.004024065246451751, -0.00026846103697371186, -0.0032806580459569185, -0.00022830373547562716, -0.051424872432302295, -0.0044045093219138645, -0.0036404150488708186, -0.00023913467449469087, 0.00012711235579163712, 0.005236723147331382, 0.057798496148969085, 0.004651836636041071, -0.004438780120678811, -0.04698328244384036, -0.004169031825978456, -0.0032806580459569207, -0.0037863971509758815, -0.0015611607409507415, -7.630734535704799e-05, 0.002468052562942664, 0.0043822337072097995, 0.00417938386932557, 0.04989959869263653, 0.004382233707209798, 0.004179383869325582, 0.0024680525629426674, 0.004702720137837073, 0.054110017909500964, 0.004866080220235801, 0.004406576266662166, 0.0027048764098513596, 0.00016336008239872774, -0.00019426887650971818, -0.0037490175335988182, -0.0042983704767240285, -0.0479717429681863, -0.004247106138382343, -0.00395658469165967, -0.004566006580397162, -0.05238738952169474, -0.00327485346433285, -0.004573513020470905, -0.001537554075438232, 0.0002658394147157541, 0.0023300812537566467, 0.004573513020470913, 0.0487535439532685, 0.00034211853946147395, 0.004307673605755158, -0.07107408951180394, -0.005987173189320227, -0.0048115223928499925, -0.056708496245549335, 0.0038800636835164375, 0.0003463305798848575, 0.04336311244428756, 0.00417938386932557, -0.0006794751021880241, 0.0012360301859325247, 7.527986293138571e-05, -0.0022411615753155497, -0.004298370476724033, -0.04798340781305179, -0.0042983704767240285, -0.002241161575315534, -0.004362968373624243, -0.0492919750032704, -0.004566006580397162, -0.0010705705958767118, -0.0023300812537566436, -0.00020303820677293846, -0.0007092239947736832, 0.0038775143172799505, 0.00429837047672401, 0.0507809396266501, 0.0032149188102567052, 0.003956584691659698, 0.004566006580397202, 0.05238738952169481, 0.004573513020470913, 0.0032748534643328425, 0.0015375540754382377, -0.00088363198126292, -0.0027048764098513336, -0.0042024077725311285, -0.004310158474954788, -0.05098850485523211, -0.00342652649369185, 0.005610804808385128, 0.07017513284087026, 0.00447880799203536, 0.0009424649416523055, -0.00484722186310089, -0.048641660242500606, 0.0008532916317665745, -0.004866080220235784, -0.00039769804396813576, -0.047327787094356075, -0.004310158474954788, -0.0012878279715257763, 0.00023913467449468556, 0.0024357367765050716, 0.005073363064932684, 0.0517359129778391, 0.0021966021020103596, -0.006439466570551471, -0.06747510717693889, -0.002826891223879904, 0.0007567621287058402, -0.0012937747540244806, -0.003907059772313509, -0.04950653577288592, 0.0017199849029143769, 0.004940183589820721, 0.06469399742292417, 0.0014682712146046105, -0.0013182475212388282, -0.0028268912238798884, -0.06246099920471852, -0.10847236461166136, 0.07559996703043675, 0.046630508514554025, 0.0021966021020103604, 0.0009706506838848016, -0.0003898545958344824, -0.00012711235579163712, -0.04950653577288592, -0.003907059772313526, -0.0012937747540244689, 0.0007567621287058343, 0.04089796062306344, 0.0033168500479782027, 0.0010583555692125677, -0.0005929178225359963, -0.0005929178225359929, 0.0003647843398296974, 0.0001085070071163876, 2.8264270447871874e-05, 0.05341359554519939, 0.005236723147331382, -0.000873833637441675, -0.044214810671041625, -0.004438780120678811, -0.0021489924324162063, -0.00022830373547563925, 0.0006846425288969675, -7.630734535704239e-05, -0.00013677127756427413, 0.00381231175559483, 0.04144784925887015, 0.0003463305798848575, 0.0043822337072097995, -0.0007010511266446017, -0.0006794751021880111, 0.0007765427305859846, 0.046167071478621834, 0.004702720137837073, -0.0008532916317665967, -0.0007231128232918463, 0.000883631981262936, -0.00012711235579163162, -0.058097463119911257, -0.0048115223928499925, 0.04558067158157532, 0.00381231175559483, 0.0038800636835164375, 0.002468052562942664, 0.0007765427305859982, 7.527986293138131e-05, -0.00032545703307396747, -0.0042471061383823555, -0.04797174296818626, -0.004298370476724033, -0.0037490175335988182, -0.00019426887650973374, -0.05037331224156621, -0.004362968373624243, -0.00395658469165967, 0.0006697434260839638, -0.00026583941471574604, -0.0004765232046902746, 0.0010361405354907878, 0.00429837047672401, 0.04675742979815836, 0.00429837047672401, 0.001036140535490781, 0.004362968373624236, 0.04929197500327039, 0.004566006580397202, 0.0023300812537566467, 0.001070570595876702, 0.00020303820677294932, 0.0007231128232918335, -0.004406576266662144, -0.04568065038929392, -0.00039769804396813576, -0.0042024077725311285, -0.0011208108672599816, 0.06459529017882072, 0.005610804808385128, 0.001522181122491604, 0.06226436374299698, -0.04613170864133813, -0.0042471061383823555, -0.0022411615753155497, -0.00019426887650971818, 0.00038875954306311045, 0.0032149188102567113, 0.050780939626650166, 0.00429837047672401, 0.0038775143172799505, -0.0007092239947736772, 0.050373312241566326, 0.004362968373624236, 0.003956584691659698, 0.0002658394147157541, -0.0006697434260839583, 0.0004765232046902741, -0.004847221863100893, -0.05420242585359838, -0.00484722186310089, -0.004702720137837072, -0.05411001790950105, -0.004406576266662144, -0.004866080220235784, -0.0027048764098513336, -0.00016336008239872102, 0.0036404150488708272, 0.004611065732755639, 0.052234718511073905, 0.005073363064932684, 0.0009706506838848127, -0.0694543896785582, -0.006439466570551471, -0.001318247521238836, 0.004476893852306117, 0.05406101903645903, 0.004404509321913853, 0.05090790548067611, 0.004611065732755639, 0.0024357367765050716, -0.0003898545958344898, -0.0037473593264603002, -0.004561059714365358, -0.05536137024127573, -0.003907059772313509, 0.005479557592380922, 0.06973446608241349, 0.004940183589820721, 0.0006908026212014055, -0.0008738336374416753, 0.0052367231473313975, 0.053413595545199324, -0.006439466570551459, -0.06747510717693889, -0.0028268912238798884, 0.0015221811224916074, 0.004478807992035359, 0.06462007304052449, 0.1084723646116613, -0.062264363742996945, 0.04393550099032092, 0.0032149188102567113, 0.0010361405354907878, -0.0007092239947736832, 9.573268070244046e-05, -0.04864166024250061, -0.004847221863100893, 0.0009424649416523055, -0.046167071478621924, -0.004702720137837072, 0.0007231128232918335, 0.0008532916317665745, -0.00088363198126292, 0.00012711235579161907, 0.054061019036458935, 0.004476893852306117, 0.05142487243230237, 0.004404509321913853, 0.0036404150488708272, 0.00023913467449468556, -0.00012711235579162606, -0.00450412145516615, -0.05016053571493779, -0.004561059714365358, -0.0012937747540244806, 0.06397483208617721, 0.005479557592380922, 0.0017199849029143769, 0.0002097318752974471, -0.058537912888765094, -0.0527524810345502, -0.00450412145516615, -0.0037473593264603002, 0.0007567621287058402, 0.004651836636041075, 0.05779849614896913, 0.0052367231473313975, -0.0694543896785581, -0.006439466570551459, -0.0013182475212388282, -0.004811522392849978, -0.058097463119911257, 0.005610804808385101, 0.07017513284087029, 0.004478807992035359, -0.005987173189320217, -0.06767968137282934, -0.10847236461166122, 0.058537912888765094, 0.049675580314884234, 0.004651836636041075, -0.0008738336374416753, -0.05670849624554929, -0.004811522392849978, 0.06459529017882074, 0.005610804808385101, 0.0015221811224916074, 0.062264363742997056, -0.07107408951180397, -0.005987173189320217, 0.005797055513274202, 0.07163982420163309, 0.10847236461166132, -0.06226436374299703, 0.06711394668300022, 0.005797055513274202, -0.07559996703043674, -0.10847236461166138, 0.07559996703043671, 0.1084723646116613, -0.10847236461166132, 0.20459965308857028};


	printf("PH:status = %d\n", meausre_PH(vec, resu));
	//pairingOp(A1_list, A_matirx, vec, resu, l, m, 0, 1);
	//pairingABlmOp(A_matirx, B_matirx, A1_list, vec, resu, l, m, la, lb, 1);
	//twoOpGeneral(A_matirx, A1_list, vec, resu, m, 1);

	//exchangeAB();
	//bi.entropy(vec, A.basis, alphalist, betalist, 16, A.dim);
	hutm.showAllSorted();
	return 0;
}


extern "C" int createA2BdoywithNo(double *pseudo, double *A_list2, int N_o, int num_thread)
{
	struct CG2 cg;
	cg.cg = NULL;
	int st = 0;
	st = createCG2Bdoy(&cg, N_o);
	if(st!=0)
	{
		printf("createCG2Bdoy\t%d\n", st);
		return st;
	}
	cal2BodyAlist(&cg, pseudo, A_list2, num_thread);
	destoryCG2(&cg);
	return st;
}


extern "C" int createO00AwithNo(double *olist, double *A_list2, int N_o, int num_thread)
{
	struct CG2 cg;
	cg.cg = NULL;
	int st = 0;
	st = createCG2Bdoy(&cg, N_o);
	if(st!=0)
	{
		printf("createCG2Bdoy\t%d\n", st);
		return st;
	}
	calO00Alist(&cg, olist, A_list2, num_thread);
	destoryCG2(&cg);
	return st;
}


extern "C" int createOL0AwithNo(double *olist, double *A_list2, int L, int N_o, int num_thread)
{
	struct CG2 cg;
	cg.cg = NULL;
	int st = 0;
	st = createCG2Bdoy(&cg, N_o);
	if(st!=0)
	{
		printf("createCG2Bdoy\t%d\n", st);
		return st;
	}
	calOL0Alist(&cg, olist, A_list2, L, num_thread);
	destoryCG2(&cg);
	return st;
}

extern "C" int creatennL0AwithNo(double *A_list2, int L, int N_o, int num_thread)
{
	calnnl0Alist(A_list2, L, N_o, num_thread);
	return 0;
}

extern "C" int create_nlm_nlm_AwithNo(double *A_list2, double *olist, int L, int N_o, int num_thread)
{
	cal_nlm_nlm_Alist(A_list2, olist, L, N_o, num_thread);
	return 0;
}

extern "C" int create_nl1m_nl2m_AwithNo(double *A_list2, int l_1, int l_2, int m, int N_o, int num_thread)
{
	cal_nl1m_nl2m_Alist(A_list2, l_1, l_2, m, N_o, num_thread);
	return 0;
}

extern "C" int create_delta_AwithNo(double *A_list2, int l, int m, int N_o, int num_thread)
{
	cal_delta_Alist(A_list2, l, m, N_o, num_thread);
	return 0;
}

extern "C" int create_deltadelta_ABwithNo(double *A_list2, int l, int m, int la, int lb, int N_o, int num_thread)
{
	//printf("l=%d, la=%d, lb=%d\n", l ,la ,lb);
	cal_deltadelta_lalb_Alist(A_list2, l, m, la, lb, N_o, num_thread);
	return 0;
}

extern "C" int create_nlm_AwithNo(double *A_list2, int l, int m, int N_o, int num_thread)
{
	//printf("l=%d, la=%d, lb=%d\n", l ,la ,lb);
	cal_nlm_Alist(A_list2, l, m, N_o, num_thread);
	return 0;
}

extern "C" int init_FQHE(size_t N_o, size_t N_e)
{
	A.ProjectionQ = 0;
	A.N_o = N_o;
	A.N_tot_o = 2*N_o;
	A.N_e = N_e;

	A.L_z = 0;
	A.Z_2 = (int)0;
	A.PH = (int)0;
	A.n_data = ULIMAX;

	if(A.basis!=NULL)
	{
		free(A.basis);
		A.basis = NULL;
	}

	if(A.Z2_num!=NULL)
	{
		free(A.Z2_num);
		A.Z2_num = NULL;
	}

	if(A.Z2_phase!=NULL)
	{
		free(A.Z2_phase);
		A.Z2_phase = NULL;
	}
	if(A.PH_phase!=NULL)
	{
		free(A.PH_phase);
		A.PH_phase = NULL;
	}
	if(A.Z2PH_length!=NULL)
	{
		free(A.Z2PH_length);
		A.Z2PH_length = NULL;
	}

	A.dim = ULIMAX;
	A.Z2dim = ULIMAX;

	if(A.PHindex!=NULL)
	{
		free(A.PHindex);
		A.PHindex = NULL;
	}

	//if(A.partition!=NULL)
	//{	
	//	free(A.partition);
	//	A.partition=NULL;
	//}
	A.hashT.clear();
	A.PHhashT.clear();
	return 0;
}


extern "C" int create_Lz_space(size_t L_z)
{
	if(A.L_z == L_z&&A.Z_2==0&&A.PH==0)
		return 0;
	A.L_z = L_z;
	A.Z_2 = (int)0;
	A.PH = (int)0;
	A.Z2dim = ULIMAX;

	if(A.basis!=NULL)
	{
		free(A.basis);
		A.basis = NULL;
	}

	if(A.Z2_num!=NULL)
	{
		free(A.Z2_num);
		A.Z2_num = NULL;
	}

	if(A.Z2_phase!=NULL)
	{
		free(A.Z2_phase);
		A.Z2_phase = NULL;
	}
	if(A.PH_phase!=NULL)
	{
		free(A.PH_phase);
		A.PH_phase = NULL;
	}
	if(A.Z2PH_length!=NULL)
	{
		free(A.Z2PH_length);
		A.Z2PH_length = NULL;
	}
	if(A.PHindex!=NULL)
	{
		free(A.PHindex);
		A.PHindex = NULL;
	}
	A.hashT.clear();
	A.PHhashT.clear();

	int st = 0;
	size_t o = 0;
	st = fermionLzBasisCount(A.N_tot_o, A.N_e, A.L_z, A.N_e, A.N_o, &o);
	if(st!=0)
	{
		printf("fermionLzBasisCount\t%d\n", st);
		return st;
	}
	Data_basis *temp =  (Data_basis *)malloc((size_t)A.N_e * sizeof(Data_basis));
	A.basis = (Data_basis *)malloc((size_t)o * A.N_e * sizeof(Data_basis));
	if(A.basis==NULL)
		return 1;
	A.dim = o;
	o =0;
	st = fermionLzBasis(A.N_tot_o, A.N_e, A.L_z, temp, A.basis, A.N_e, A.N_o, &o);
	if(st!=0||o!=A.dim)
	{
		printf("fermionLzBasis\t%d\n", st);
		return st;
	}
	free(temp);

	basis_to_num(A.basis, A.dim, A.N_e, A.hashT);

	#ifdef __PRINT_BASIS
	#ifdef __PRINT_BASIS_DETAIL
	Data_basis *basis_t = A.basis;
	for(size_t i=0;i<A.dim;++i)
	{
		for(size_t j=0;j<A.N_e;++j)
		{
			if(basis_t[j]<A.N_o)
				printf("%d ",basis_t[j]);
			else
				printf("\033[1;31m%d \033[0m",basis_t[j]);
		}
		auto it = A.hashT.find(dict_num(basis_t, A.N_e));
		if(it!=A.hashT.end())
			printf("\t%u\t%lu\t%u\n",dict_num(basis_t, A.N_e),i,it->second);
		else
		{
			printf("\t%u\t%lu\tnot found!!!\n",dict_num(basis_t, A.N_e),i);
			return -1;
		}
		basis_t += A.N_e;
	}
	#endif
	printf("create Lz spcae status: %d\n", st);
	printf("The dimension of hilbert space (Lz=%lf) is: %lu\n", A.L_z-(A.N_o-1)*A.N_e/2.0, A.dim);
	#endif
	return 0;
}


extern "C" void copy_basis(char* basis)
{
	for(size_t i=0;i<A.dim*A.N_e;++i)
		basis[i] = A.basis[i];
	return;
}

extern "C" int get_n_o(){return (int)A.N_o;}
extern "C" int get_n_e(){return (int)A.N_e;}
//void set_Hermitian(MKL_INT HermitianQ){A.HermitianQ=HermitianQ;}
//MKL_INT get_Hermitian(){return A.HermitianQ;}
extern "C" size_t get_Lz_dim(){return A.dim;}


extern "C" int create_Lz_Z2_space(size_t L_z, int Z_2)// Z_2: -1 or 1
{
	if(A.L_z == L_z && A.Z_2 == Z_2 && A.PH==0)
		return 0;
	A.L_z = L_z;
	A.Z_2 = Z_2;
	A.PH = (int)0;

	if(A.basis!=NULL)
	{
		free(A.basis);
		A.basis = NULL;
	}
	if(A.Z2_num!=NULL)
	{
		free(A.Z2_num);
		A.Z2_num = NULL;
	}

	if(A.Z2_phase!=NULL)
	{
		free(A.Z2_phase);
		A.Z2_phase = NULL;
	}
	if(A.PH_phase!=NULL)
	{
		free(A.PH_phase);
		A.PH_phase = NULL;
	}
	if(A.Z2PH_length!=NULL)
	{
		free(A.Z2PH_length);
		A.Z2PH_length = NULL;
	}
	if(A.PHindex!=NULL)
	{
		free(A.PHindex);
		A.PHindex = NULL;
	}
	A.hashT.clear();
	A.PHhashT.clear();

	int st = 0;
	Data_basis *temp =  (Data_basis *)malloc((size_t)A.N_e * sizeof(Data_basis));
	size_t o = 0;
	st = fermionLzZ2BasisCount(A.N_tot_o, A.N_e, A.L_z, A.Z_2, temp, A.N_e, A.N_o, A.ProjectionQ, &o);
	if(st!=0)
	{
		printf("fermionLzBasisCount\t%d\n", st);
		return st;
	}
	A.basis = (Data_basis *)malloc((size_t)o * A.N_e * sizeof(Data_basis));
	if(A.basis==NULL)
		return 1;
	A.Z2_phase = (char *)malloc((size_t)o * sizeof(char));
	if(A.Z2_phase==NULL)
		return 1;

	#ifdef __PRINT_Z2INDEX
	A.Z2_num = (size_t *)malloc((size_t)o * sizeof(size_t));
	if(A.Z2_num==NULL)
		return 1;
	#endif

	A.dim = o;
	A.Z2dim = A.dim;
	o =0;
	st = fermionLzZ2Basis(A.N_tot_o, A.N_e, A.L_z, A.Z_2, temp, A.basis, A.Z2_phase, A.Z2_num, A.N_e, A.N_o, A.ProjectionQ, &o);
	if(st!=0 || o!=A.dim)
	{
		printf("\033[1;31mfermionLzZ2Basis:\tst=%d or o(%lu)!=A.dim(%lu)\n \033[0m", st, o, A.dim);
		return st;
	}
	free(temp);

	basis_to_num(A.basis, A.dim, A.N_e, A.hashT);

	#ifdef __PRINT_BASIS
	#ifdef __PRINT_BASIS_DETAIL
	Data_basis *basis_t = A.basis;
	for(size_t i=0;i<A.dim;++i)
	{
		for(size_t j=0;j<A.N_e;++j)
		{
			if(basis_t[j]<A.N_o)
				printf("%d ",basis_t[j]);
			else
				printf("\033[1;31m%d \033[0m",basis_t[j]);
		}
		auto it = A.hashT.find(dict_num(basis_t, A.N_e));
		if(it!=A.hashT.end())
		{
			#ifdef __PRINT_Z2INDEX
			printf(": %+d\t%lu\t%u\t%lu\t%u\n", A.Z2_phase[i],A.Z2_num[i],dict_num(basis_t, A.N_e),i,it->second);
			#else
			printf(": %+d\t%u\t%lu\t%u\n", A.Z2_phase[i],dict_num(basis_t, A.N_e),i,it->second);
			#endif
		}
		else
		{
			printf("\t%u\t%lu\tnot found!!!\n",dict_num(basis_t, A.N_e),i);
			return -1;
		}
		basis_t += A.N_e;
	}
	#endif
	printf("create Lz+Z2 spcae status: %d\n", st);
	printf("The dimension of hilbert space (Lz=%lf, Z_2=%+d) is: %lu\n", A.L_z-(A.N_o-1)*A.N_e/2.0, A.Z_2, A.dim);
	#endif
	return 0;
}

extern "C" int create_Lz_Z2PH_space(size_t L_z, int Z_2, int PH)// Z_2, PH: -1 or 1
{
	int st = 0;
	if(A.L_z == L_z && A.Z_2 == Z_2 && A.PH == PH)
		return 0;
	if(A.L_z != L_z || A.Z_2 != Z_2)
		st = create_Lz_Z2_space(L_z, Z_2);

	if(A.PH_phase!=NULL)
	{
		free(A.PH_phase);
		A.PH_phase = NULL;
	}
	if(A.Z2PH_length!=NULL)
	{
		free(A.Z2PH_length);
		A.Z2PH_length = NULL;
	}
	if(A.PHindex!=NULL)
	{
		free(A.PHindex);
		A.PHindex = NULL;
	}
	A.PHhashT.clear();

	Data_basis *basis_t = A.basis;
	Data_basis *PHbasis = (Data_basis *)malloc((size_t)A.N_e * sizeof(Data_basis));
	char phase;
	size_t ind, count=0;
	int n_find;
	// 		1        basis_t 			 	+						[ phase[4*row+0] ]
	//		2       Z_2*basis_t 		Z_2 sign  					[ phase[4*row+1] ]
	//		3       PH*basis_t 			PH  sign  					[ phase[4*row+2] ]
	//		4       Z_2*PH*basis_t 		(PH  sign)*(Z_2' sign') 	[ phase[4*row+3] ]
	for(size_t i=0;i<A.Z2dim;++i)
	{	
		basis_t = A.basis + i*A.N_e;
		PH_transformation(basis_t, PHbasis, A.N_o, A.N_e, &phase);
		ind = find_Z2_index(PHbasis, A.hashT, A.N_e, A.N_o, n_find);
		//printf("PH=%d, i=%lu, ind=%lu, phase=%d, (%d, %d)\n", PH, i, ind, phase, ind!=ULIMAX, ind<i);
		if(ind==ULIMAX || ind<i)
			continue;
        int state = phase*( (ind==i)?1:2 );

        if(PH==1)// P(+)|phase=+1> and P(-)|phase=-1, T=2>
        {
            if(state==-1) 
                continue;
        }
        else if(PH==-1)// P(-)|phase=+1> and P(+)|phase=-1, T=2> and P(-)|phase=+1, T=2>
        {
            if(state==1) 
                continue;
        }
        else if(PH!=1 || PH!=-1)
            continue;
        count++;
		//printf("%lu\n", count);
	}
	//printf("%lu\n", count);


	A.PH_phase = (char *)malloc((size_t)count * sizeof(char));
	A.Z2PH_length = (char *)malloc((size_t)count * sizeof(char));
	A.PHindex = (size_t *)malloc((size_t)count * sizeof(size_t));
	count = 0;
	//Data_basis *Z2basis = (Data_basis *)malloc((size_t)A.N_e * sizeof(Data_basis));
	for(size_t i=0;i<A.Z2dim;++i)
	{	
		basis_t = A.basis + i*A.N_e;
		PH_transformation(basis_t, PHbasis, A.N_o, A.N_e, &phase);
		ind = find_Z2_index(PHbasis, A.hashT, A.N_e, A.N_o, n_find);

		//print_basis(basis_t, A.N_e, A.N_o);
		PH_transformation(basis_t, PHbasis, A.N_o, A.N_e, &phase);
		//printf(" PH: ");
		//print_basis(PHbasis, A.N_e, A.N_o);
		//printf("PH=%d, i=%lu, ind=%lu, phase=%d, (%d, %d)\n", PH, i, ind, phase, ind!=ULIMAX, ind<i);
		if(ind==ULIMAX || ind<i)
			continue;
        int state = phase*( (ind==i)?1:2 );

        if(PH==1)// P(+)|phase=+1> and P(-)|phase=-1, T=2>
        {
            if(state==-1) 
                continue;
        }
        else if(PH==-1)// P(-)|phase=+1> and P(+)|phase=-1, T=2> and P(-)|phase=+1, T=2>
        {
            if(state==1) 
                continue;
        }
        else if(PH!=1 || PH!=-1)
            continue;

        A.PH_phase[count] = state;
        A.PHindex[count] = i;
        //A.PHhashT.insert({dict_num(basis_t, N_e), count});
        A.PHhashT.insert({i, count});
        A.Z2PH_length[count] = std::abs( state*A.Z2_phase[ind] );
        count++;
	}
	free(PHbasis);
	A.dim = count;
	A.PH = PH;

	#ifdef __PRINT_BASIS
	#ifdef __PRINT_BASIS_DETAIL
	//size_t ind;
	basis_t = A.basis;
	PHbasis = (Data_basis *)malloc((size_t)A.N_e * sizeof(Data_basis));
	Data_basis *Z2basis = (Data_basis *)malloc((size_t)A.N_e * sizeof(Data_basis));
	for(size_t i=0;i<A.dim;++i)
	{
		int length;

		basis_t = A.basis + A.PHindex[i]*A.N_e;//*A.PHindex[i]
		print_basis(basis_t, A.N_e, A.N_o);
		ind = find_Z2PH_index(basis_t, A.hashT, A.PHhashT, A.Z2_phase, A.PH_phase, A.Z2PH_length,\
									 	A.PHindex, A.N_e, A.N_o, length, phase);
		//if(ind!=ULIMAX)
			printf("(ind=%lu,phi=%+d,l=%d)", ind, phase, length);

		printf(" Z2: ");
		Z2_transformation(basis_t, Z2basis, A.N_o, A.N_e, &phase);
		ind = find_Z2PH_index(Z2basis, A.hashT, A.PHhashT, A.Z2_phase, A.PH_phase, A.Z2PH_length,\
									 	A.PHindex, A.N_e, A.N_o, length, phase);
		print_basis(Z2basis, A.N_e, A.N_o);
		//if(ind!=ULIMAX)
			printf("(ind=%lu,phi=%+d,l=%d)", ind, phase, length);

		printf(" PH: ");
		PH_transformation(basis_t, PHbasis, A.N_o, A.N_e, &phase);
		ind = find_Z2PH_index(PHbasis, A.hashT, A.PHhashT, A.Z2_phase, A.PH_phase, A.Z2PH_length,\
									 	A.PHindex, A.N_e, A.N_o, length, phase);
		print_basis(PHbasis, A.N_e, A.N_o);
		//if(ind!=ULIMAX)
			printf("(ind=%lu,phi=%+d,l=%d)", ind, phase, length);

		printf(" Z2PH: ");
		Z2_transformation(PHbasis, Z2basis, A.N_o, A.N_e, &phase);
		ind = find_Z2PH_index(Z2basis, A.hashT, A.PHhashT, A.Z2_phase, A.PH_phase, A.Z2PH_length,\
									 	A.PHindex, A.N_e, A.N_o, length, phase);
		print_basis(Z2basis, A.N_e, A.N_o);
		//if(ind!=ULIMAX)
			printf("(ind=%lu,phi=%+d,l=%d)", ind, phase, length);
		printf("\n");
	}
	free(Z2basis);
	free(PHbasis);
	#endif
	printf("create Lz+Z2+PH spcae status: %d\n", st);
	printf("The dimension of hilbert space (Lz=%lf, Z_2=%+d, PH=%+d) is: %lu\n", A.L_z-(A.N_o-1)*A.N_e/2.0, A.Z_2, A.PH, A.dim);
	#endif
	return 0;
}

extern "C" void set_Projection(int ProjectionQ)
{
	if(A.ProjectionQ!=ProjectionQ)
	{
		init_FQHE(A.N_o, A.N_e);
		A.ProjectionQ = ProjectionQ;
	}
}

int init_FQHE_G(size_t N_o, size_t N_e, struct FQHE& AA)
{
	AA.ProjectionQ = 0;
	AA.N_o = N_o;
	AA.N_tot_o = 2*N_o;
	AA.N_e = N_e;

	AA.L_z = 0;
	AA.Z_2 = (int)0;
	AA.PH = (int)0;
	AA.n_data = ULIMAX;

	if(AA.basis!=NULL)
	{
		free(AA.basis);
		AA.basis = NULL;
	}

	if(AA.Z2_num!=NULL)
	{
		free(AA.Z2_num);
		AA.Z2_num = NULL;
	}

	if(AA.Z2_phase!=NULL)
	{
		free(AA.Z2_phase);
		AA.Z2_phase = NULL;
	}
	if(AA.PH_phase!=NULL)
	{
		free(AA.PH_phase);
		AA.PH_phase = NULL;
	}
	if(AA.Z2PH_length!=NULL)
	{
		free(AA.Z2PH_length);
		AA.Z2PH_length = NULL;
	}

	AA.dim = ULIMAX;
	AA.Z2dim = ULIMAX;

	if(AA.PHindex!=NULL)
	{
		free(AA.PHindex);
		AA.PHindex = NULL;
	}

	//if(A.partition!=NULL)
	//{	
	//	free(A.partition);
	//	A.partition=NULL;
	//}
	AA.hashT.clear();
	AA.PHhashT.clear();
	return 0;
}

extern "C" int init_FQHE_type(size_t N_o, size_t N_e, size_t type)
{
	struct FQHE& AA = (type==0)?A:B;
	init_FQHE_G(N_o, N_e, AA);
	return 0;
}


extern "C" int create_Lz_space_type(size_t L_z, size_t type)
{
	struct FQHE& AA = (type==0)?A:B;

	if(AA.L_z == L_z&&AA.Z_2==0&&AA.PH==0)
		return 0;
	AA.L_z = L_z;
	AA.Z_2 = (int)0;
	AA.PH = (int)0;
	AA.Z2dim = ULIMAX;

	if(AA.basis!=NULL)
	{
		free(AA.basis);
		AA.basis = NULL;
	}

	if(AA.Z2_num!=NULL)
	{
		free(AA.Z2_num);
		AA.Z2_num = NULL;
	}

	if(AA.Z2_phase!=NULL)
	{
		free(AA.Z2_phase);
		AA.Z2_phase = NULL;
	}
	if(AA.PH_phase!=NULL)
	{
		free(AA.PH_phase);
		AA.PH_phase = NULL;
	}
	if(AA.Z2PH_length!=NULL)
	{
		free(AA.Z2PH_length);
		AA.Z2PH_length = NULL;
	}
	if(AA.PHindex!=NULL)
	{
		free(AA.PHindex);
		AA.PHindex = NULL;
	}
	AA.hashT.clear();
	AA.PHhashT.clear();

	int st = 0;
	size_t o = 0;
	st = fermionLzBasisCount(AA.N_tot_o, AA.N_e, AA.L_z, AA.N_e, AA.N_o, &o);
	if(st!=0)
	{
		printf("fermionLzBasisCount\t%d\n", st);
		return st;
	}
	Data_basis *temp =  (Data_basis *)malloc((size_t)AA.N_e * sizeof(Data_basis));
	AA.basis = (Data_basis *)malloc((size_t)o * AA.N_e * sizeof(Data_basis));
	if(AA.basis==NULL)
		return 1;
	AA.dim = o;
	o =0;
	st = fermionLzBasis(AA.N_tot_o, AA.N_e, AA.L_z, temp, AA.basis, AA.N_e, AA.N_o, &o);
	if(st!=0||o!=AA.dim)
	{
		printf("fermionLzBasis\t%d\n", st);
		return st;
	}
	free(temp);

	basis_to_num(AA.basis, AA.dim, AA.N_e, AA.hashT);

	#ifdef __PRINT_BASIS
	#ifdef __PRINT_BASIS_DETAIL
	Data_basis *basis_t = AA.basis;
	for(size_t i=0;i<AA.dim;++i)
	{
		for(size_t j=0;j<AA.N_e;++j)
		{
			if(basis_t[j]<AA.N_o)
				printf("%d ",basis_t[j]);
			else
				printf("\033[1;31m%d \033[0m",basis_t[j]);
		}
		auto it = AA.hashT.find(dict_num(basis_t, AA.N_e));
		if(it!=AA.hashT.end())
			printf("\t%u\t%lu\t%u\n",dict_num(basis_t, AA.N_e),i,it->second);
		else
		{
			printf("\t%u\t%lu\tnot found!!!\n",dict_num(basis_t, AA.N_e),i);
			return -1;
		}
		basis_t += AA.N_e;
	}
	#endif
	printf("create Lz spcae status: %d\n", st);
	printf("The dimension of hilbert space (Lz=%lf) is: %lu\n", AA.L_z-(AA.N_o-1)*AA.N_e/2.0, AA.dim);
	#endif
	return 0;
}

extern "C" int get_B_n_o(){return (int)B.N_o;}
extern "C" int get_B_n_e(){return (int)B.N_e;}
//void set_Hermitian(MKL_INT HermitianQ){A.HermitianQ=HermitianQ;}
//MKL_INT get_Hermitian(){return A.HermitianQ;}
extern "C" size_t get_B_Lz_dim(){return B.dim;}

extern "C" int init_FQHE_B(size_t N_o, size_t N_e)
{
	return init_FQHE_type(N_o, N_e, 1);
}
extern "C" int create_Lz_space_B(size_t L_z)
{
	return create_Lz_space_type(L_z, 1);
}